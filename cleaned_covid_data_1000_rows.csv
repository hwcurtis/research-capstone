sqlite3
import sqlite3
import csv
# Connect to the SQLite database (or create it if it doesn't exist)
conn = sqlite3.connect('covid_data.db')
cursor = conn.cursor()

# Create the cleaned_covid_data table
cursor.execute('''
CREATE TABLE IF NOT EXISTS cleaned_covid_data (
    positive_cases INT,
    negative_cases INT,
    currently_hospitalized INT,
    last_checked_date DATE,
    last_update_et VARCHAR(20),
    total_test_results INT,
    state CHAR(2),
    recovered_cases INT,
    currently_in_icu INT,
    new_test_results INT
)
''')

# Read the CSV file and insert data into the table
with open('cleaned_covid_data_1000_rows.csv', 'r') as csvfile:
    reader = csv.reader(csvfile)
    df = pd.read_csv(csvfile)
    print(df.head(10))
    next(reader)  # Skip header row
    for row in reader:
        cursor.execute('''
        INSERT INTO cleaned_covid_data (positive_cases, negative_cases, currently_hospitalized, last_checked_date, last_update_et, total_test_results, state, recovered_cases, currently_in_icu, new_test_results)
        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
        ''', row)

# Commit changes and close the connection
conn.commit()
conn.close()

13448,10190,921,2022-07-28,07/28/2022 13:00,6551,FL,13011,125,2749
13526,39196,157,2022-07-29,07/29/2022 13:00,70359,NY,8947,123,2146
3273,40449,345,2022-07-30,07/30/2022 13:00,187952,NY,14885,33,2915
46427,40661,80,2022-07-31,07/31/2022 13:00,145988,MI,11060,1,974
10378,30709,242,2022-08-01,08/01/2022 13:00,128150,GA,13635,6,3379
43446,81428,343,2022-08-02,08/02/2022 13:00,174517,OH,8334,41,3084
10877,76179,820,2022-08-03,08/03/2022 13:00,49636,MI,10603,183,2278
7847,10943,675,2022-08-04,08/04/2022 13:00,31685,NY,24407,5,3907
34276,44240,99,2022-08-05,08/05/2022 13:00,53134,CA,5222,187,707
4283,46760,343,2022-08-06,08/06/2022 13:00,90916,FL,9952,80,734
4798,22042,208,2022-08-07,08/07/2022 13:00,109967,NY,5487,18,4679
5168,44894,170,2022-08-08,08/08/2022 13:00,96455,TX,29367,177,2827
21171,7869,547,2022-08-09,08/09/2022 13:00,173065,GA,7731,82,1174
35320,62078,130,2022-08-10,08/10/2022 13:00,177405,GA,7326,65,2014
34984,57759,310,2022-08-11,08/11/2022 13:00,191937,GA,5208,83,688
33578,45306,733,2022-08-12,08/12/2022 13:00,51756,PA,18708,182,3331
47659,56371,584,2022-08-13,08/13/2022 13:00,124863,PA,2210,189,2404
21422,21918,972,2022-08-14,08/14/2022 13:00,63192,IL,1057,136,3938
34528,29379,445,2022-08-15,08/15/2022 13:00,193758,NC,7246,131,2073
46425,91810,77,2022-08-16,08/16/2022 13:00,50733,FL,660,25,2155
20816,84232,774,2022-08-17,08/17/2022 13:00,27993,MI,26006,69,3580
11960,3962,931,2022-08-18,08/18/2022 13:00,163564,OH,23897,183,2179
17468,14851,468,2022-08-19,08/19/2022 13:00,154053,NY,1412,168,3152
30766,46747,523,2022-08-20,08/20/2022 13:00,26143,NC,18305,82,4582
30709,53349,407,2022-08-21,08/21/2022 13:00,193349,OH,27678,178,1351
24500,71832,629,2022-08-22,08/22/2022 13:00,109044,MI,11695,117,3895
14511,57356,295,2022-08-23,08/23/2022 13:00,183062,NC,22130,95,3922
3366,15745,570,2022-08-24,08/24/2022 13:00,130406,OH,21429,33,4402
47633,6730,149,2022-08-25,08/25/2022 13:00,195960,CA,5474,111,3489
6398,14921,739,2022-08-26,08/26/2022 13:00,71351,PA,2751,146,1880
18895,99430,565,2022-08-27,08/27/2022 13:00,183071,MI,10106,125,2704
39519,72138,938,2022-08-28,08/28/2022 13:00,72309,FL,10033,185,3788
38207,84111,790,2022-08-29,08/29/2022 13:00,145518,TX,21185,16,4988
4506,20023,599,2022-08-30,08/30/2022 13:00,163805,CA,28484,80,1824
34893,46349,737,2022-08-31,08/31/2022 13:00,121156,PA,16272,38,2884
11456,82533,903,2022-09-01,09/01/2022 13:00,78000,GA,2977,169,3819
31163,84286,619,2022-09-02,09/02/2022 13:00,181704,PA,22066,135,1777
6578,42979,757,2022-09-03,09/03/2022 13:00,23576,NC,27946,78,548
30131,23837,291,2022-09-04,09/04/2022 13:00,5320,IL,21874,181,4787
30640,15997,670,2022-09-05,09/05/2022 13:00,143822,CA,4183,63,181
42191,89603,933,2022-09-06,09/06/2022 13:00,105002,GA,845,112,1506
4461,46039,825,2022-09-07,09/07/2022 13:00,186535,NC,8849,89,1580
29777,21923,945,2022-09-08,09/08/2022 13:00,28572,MI,27977,160,1179
42074,9876,587,2022-09-09,09/09/2022 13:00,19948,FL,17425,38,3698
31917,61973,755,2022-09-10,09/10/2022 13:00,118528,PA,20507,150,4614
22984,3887,466,2022-09-11,09/11/2022 13:00,171898,MI,18780,144,4283
18603,64723,96,2022-09-12,09/12/2022 13:00,91051,GA,17423,52,3780
29845,43422,88,2022-09-13,09/13/2022 13:00,29867,NC,18094,29,2803
46826,52413,214,2022-09-14,09/14/2022 13:00,193303,IL,22784,144,4410
39954,3841,800,2022-09-15,09/15/2022 13:00,199334,PA,1825,76,3856
2087,29756,346,2022-09-16,09/16/2022 13:00,46678,FL,25660,145,1858
43071,72576,263,2022-09-17,09/17/2022 13:00,109561,IL,26263,64,2699
21531,11304,313,2022-09-18,09/18/2022 13:00,14963,OH,12313,91,2650
26712,31341,389,2022-09-19,09/19/2022 13:00,197432,NC,9628,89,3953
10850,5758,139,2022-09-20,09/20/2022 13:00,51434,MI,14262,13,2846
19316,18010,605,2022-09-21,09/21/2022 13:00,68617,PA,27813,72,2392
20788,61758,285,2022-09-22,09/22/2022 13:00,153341,PA,8953,184,1601
29932,32658,708,2022-09-23,09/23/2022 13:00,119569,GA,7287,5,4504
44722,50002,567,2022-09-24,09/24/2022 13:00,99352,FL,132,12,330
49117,2375,908,2022-09-25,09/25/2022 13:00,81732,TX,14993,169,4350
7337,23092,192,2022-09-26,09/26/2022 13:00,109648,OH,14508,3,1298
